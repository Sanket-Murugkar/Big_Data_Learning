SET hive.enforce.bucketing=true;

CREATE TABLE EMP_BUCKETING
(
EMPLOYEE_ID INT,FIRST_NAME STRING,LAST_NAME STRING,EMAIL STRING,PHONE_NUMBER STRING,HIRE_DATE STRING,JOB_ID STRING,SALARY INT,MANAGER_ID INT
)
PARTITIONED BY (DEPARTMENT_ID INT)
CLUSTERED BY(JOB_ID) INTO 10 BUCKETS 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';

INSERT OVERWRITE TABLE EMP_BUCKETING PARTITION(DEPARTMENT_ID)
SELECT * FROM EMP;

