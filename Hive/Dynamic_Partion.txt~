SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE TABLE EMP_DYNAMIC_PART
(
EMPLOYEE_ID INT,FIRST_NAME STRING,LAST_NAME STRING,EMAIL STRING,PHONE_NUMBER STRING,HIRE_DATE STRING,JOB_ID STRING,SALARY INT,MANAGER_ID INT
)
PARTITIONED BY (DEPARTMENT_ID INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';

INSERT OVERWRITE TABLE EMP_DYNAMIC_PART PARTITION(DEPARTMENT_ID)
SELECT * FROM EMP;




.........................................................



Two columns partion


CREATE TABLE EMP_PART4
(
EMPLOYEE_ID INT,FIRST_NAME STRING,LAST_NAME STRING,EMAIL STRING,PHONE_NUMBER STRING,HIRE_DATE STRING,JOB_ID STRING,SALARY INT
)
PARTITIONED BY (MANAGER_ID INT,DEPARTMENT_ID INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';

INSERT OVERWRITE TABLE EMP_PART4 PARTITION(MANAGER_ID,DEPARTMENT_ID)
SELECT * FROM EMP;


...................................................



ALTER TABLE EMP_PART ADD IF NOT EXISTS PARTITION(MANAGER_ID)
SELECT * FROM EMP_DYNAMIC_PART;












